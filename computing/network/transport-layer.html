<!DOCTYPE html>
<!-- TODO: Main navigation links (Home, index, tags, ...) --><!-- DoNotFormat -->
<!-- DoNotFormat -->

<html lang='en'>

<head>
  <meta charset='UTF-8' />
  <meta name='viewport' content='width=device-width, initial-scale=1' />
  <title>
    Transport Layer – エキソブレイン
  </title>
  
    
      <meta property='og:description' content='The Transport layer is the key to how networked applications talk to each other.' />
      <meta property='og:site_name' content='エキソブレイン' />
      <meta property='og:image' content />
      <meta property='og:type' content='website' />
      <meta property='og:title' content='Transport Layer' />
    
    
      <base href='/' />
      <link href='favicon.svg' rel='icon' />
    
    <!-- highlight.js -->
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/hybrid.min.css' />
<script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js'></script>
<!-- Include languages that Emanote itself uses -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/haskell.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/nix.min.js'></script>
<script>hljs.highlightAll();</script>



  
  <link href='tailwind.css?instanceId=5da82163-134e-4f99-a8e6-70829b05074c' rel='stylesheet' type='text/css' />

  <style>
    /* Heist error element */
    strong.error {
      color: lightcoral;
      font-size: 90%;
      font-family: monospace;
    }

    /* External link icon */
    a[data-linkicon=""]::after {
      content: ""
    }

    a[data-linkicon=none]::after {
      content: ""
    }

    a[data-linkicon="external"]::after {
      content: url('data:image/svg+xml,\
      <svg xmlns="http://www.w3.org/2000/svg" height="0.7em" viewBox="0 0 20 20"> \
        <g style="stroke:gray;stroke-width:1"> \
          <line x1="5" y1="5" x2="5" y2="14" /> \
          <line x1="14" y1="9" x2="14" y2="14" /> \
          <line x1="5" y1="14" x2="14" y2="14" /> \
          <line x1="5" y1="5" x2="9" y2="5"  /> \
          <line x1="10" y1="2" x2="17" y2="2"  /> \
          <line x1="17" y1="2" x2="17" y2="9" /> \
          <line x1="10" y1="9" x2="17" y2="2" style="stroke-width:1.0" /> \
        </g> \
      </svg>');
    }

    a[data-linkicon="external"][href^="mailto:"]::after {
      content: url('data:image/svg+xml,\
        <svg \
          xmlns="http://www.w3.org/2000/svg" \
          height="0.7em" \
          fill="none" \
          viewBox="0 0 24 24" \
          stroke="gray" \
          stroke-width="2"> \
          <path \
            stroke-linecap="round" \
            stroke-linejoin="round" \
            d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /> \
        </svg>');
    }
  </style>
  <!-- What goes in this file will appear on near the end of <head>--><link rel='preload' href='_emanote-static/fonts/Work_Sans/WorkSans-VariableFont_wght.ttf' as='font' type='font/ttf' crossorigin />

<style>
  @font-face {
    font-family: 'WorkSans';
    /* FIXME: This ought to be: ${ema:emanoteStaticLayerUrl}/fonts/Work_Sans/WorkSans-VariableFont_wght.ttf */
    src: url(_emanote-static/fonts/Work_Sans/WorkSans-VariableFont_wght.ttf) format("truetype");
    font-display: swap;
  }

  body {
    font-family: 'WorkSans', sans-serif;
    font-variation-settings: 'wght' 350;
  }

  a.mavenLinkBold {
    font-variation-settings: 'wght' 400;
  }

  strong {
    font-variation-settings: 'wght' 500;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  header,
  .header-font {
    font-family: 'WorkSans', sans-serif;
  }

  h1 {
    font-variation-settings: 'wght' 500;
  }

  h2 {
    font-variation-settings: 'wght' 400;
  }

  h3 {
    font-variation-settings: 'wght' 300;
  }
</style>


  
    <link rel='stylesheet' href='_emanote-static/inverted-tree.css' />
  
  <link rel='stylesheet' href='_emanote-static/stork/flat.css' />
<!-- Custom Stork-search styling for Emanote -->
<style>
  #stork-search-container {
    z-index: 1000;
    background-color: rgb(15 23 42/.8);
  }

  .stork-overflow-hidden-important {
    overflow: hidden !important;
  }
</style>


<script src='_emanote-static/stork/stork.js'></script>

  
    <script id='emanote-stork' data-emanote-base-url='/'>
      window.emanote = {};
      window.emanote.stork = {
        searchShown: false,
        indexIsStale: false,
        toggleSearch: function () {
          window.emanote.stork.refreshIndex();
          document.getElementById('stork-search-container').classList.toggle('hidden');
          window.emanote.stork.searchShown = document.body.classList.toggle('stork-overflow-hidden-important');
          if (window.emanote.stork.searchShown) {
            document.getElementById('stork-search-input').focus();
          }
        },
        clearSearch: function () {
          document.getElementById('stork-search-container').classList.add('hidden');
          document.body.classList.remove('stork-overflow-hidden-important');
          window.emanote.stork.searchShown = false;
        },

        getBaseUrl: function () {
          const baseUrl = document.getElementById("emanote-stork").getAttribute('data-emanote-base-url') || '/';
          return baseUrl;
        },

        registerIndex: function (options) {
          const indexName = 'emanote-search'; // used to match input[data-stork] attribute value
          const indexUrl = window.emanote.stork.getBaseUrl() + '-/stork.st';
          stork.register(
            indexName,
            indexUrl,
            options);
        },

        init: function () {
          if (document.readyState !== 'complete') {
            window.addEventListener('load', function () {
              stork.initialize(window.emanote.stork.getBaseUrl() + '_emanote-static/stork/stork.wasm');
              window.emanote.stork.registerIndex();
            });

            document.addEventListener('keydown', event => {
              if (window.emanote.stork.searchShown && event.key === 'Escape') {
                window.emanote.stork.clearSearch();
                event.preventDefault();
              } else if ((event.key == 'k' || event.key == 'K') && (event.ctrlKey || event.metaKey)) {
                window.emanote.stork.toggleSearch();
                event.preventDefault();
              }
            });
          } else {
            // This section is called during Ema's hot reload.
            // 
            // Mark the current index as stale, and refresh it *only when* the
            // user actually invokes search.
            // 
            // We do not refresh the index *right away*, as that will cause
            // memory leaks in the browser. See
            // https://github.com/srid/emanote/issues/411#issuecomment-1402056235
            console.log("stork: Marking index as stale");
            window.emanote.stork.markIndexAsStale();
          }
        },

        markIndexAsStale: function () {
          window.emanote.stork.indexIsStale = true;
        },

        refreshIndex: function () {
          if (window.emanote.stork.indexIsStale) {
            console.log("stork: Reloading index");
            window.emanote.stork.indexIsStale = false;
            // NOTE: This will leak memory. See the comment above.
            window.emanote.stork.registerIndex({ forceOverwrite: true });
          }
        }

      };

      window.emanote.stork.init();
    </script>
  

</head>

<!-- DoNotFormat -->



<!-- DoNotFormat -->

<body class='bg-gray-400 overflow-y-scroll'>
  
    <div class='container mx-auto max-w-prose'>
      <div class='mt-2 md:mt-4'>
        <!-- DoNotFormat -->
<!-- DoNotFormat -->

<nav id='uptree' class='flipped tree' style='transform-origin: 50%;'>
  <ul class='root'>
    <li>
      
        <ul>
          
            <li>

  <div class='text-gray-900 forest-link'>
    <a href='computing/network/networking-models'>
      Networking Models
    </a>
  </div>

  
    <ul>
      
        <li>

  <div class='text-gray-900 forest-link'>
    <a href='computing/network'>
      Network
    </a>
  </div>

  
    <ul>
      
        <li>

  <div class='text-gray-900 forest-link'>
    <a href='computing'>
      Computing
    </a>
  </div>

  
    <ul>
      
        <li>

  <div class='text-gray-900 forest-link'>
    <a href=''>
      外付け脳 (exobrain)
    </a>
  </div>

  
</li>
      
    </ul>
  
</li>
      
    </ul>
  
</li>
      
    </ul>
  
</li>
          
        </ul>
      
    </li>
  </ul>
</nav>

        <div class='relative md:shadow-2xl md:mb-8'>

          <div class='absolute -top-6 right-1 md:right-0 flex flex-row items-center justify-center'>
            <a title='Search (Ctrl+K)' class='cursor-pointer' onclick='window.emanote.stork.toggleSearch()'>
              <svg xmlns='http://www.w3.org/2000/svg' style='width: 1rem;' class='hover:text-violet-700' f
 fill='none' viewBox='0 0 24 24' stroke='currentColor' stroke-width='2'>
  <path stroke-linecap='round' stroke-linejoin='round' d='M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z'></path>
</svg>
            </a>
          </div>
          <div class='flex-1 w-full overflow-x-auto bg-white'>
            <main class='px-4 py-4'>
              <h1 class='flex items-end justify-center mb-4 p-3 bg-violet-100 text-5xl font-extrabold text-black rounded'>
  <a class='z-40 tracking-tighter '>
    Transport Layer
  </a>
</h1>
              <article class='overflow-auto'>
  <!-- What goes in this file will appear on top of note body-->
  
    <p class='mb-3'>
      The Transport layer is the key to how networked applications talk to each other.
    </p>
  
    <p class='mb-3'>
      Important concept to grasp are:
    </p>
  
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Multiplexing, demultiplexing, and the use of network ports
        </li>
      
        <li>
          How ports works with IP addresses (conceptualy, a network sockets)
        </li>
      
        <li>
          Socket object (at implementation level)
        </li>
      
        <li>
          Network (un)reliability and its engineering
        </li>
      
        <li>
          Connection-oriented and connectionless protocol
        </li>
      
        <li>
          Difference and trade-offs of TCP and UDP
        </li>
      
        <li>
          Three-way-handshake (SYN, SYN ACK, ACK)
        </li>
      
        <li>
          Congestion avoidance in TCP
        </li>
      
    </ul>
  
    <p class='mb-3'>
      Internet Protocol and its system of addressing intend to provide communication between <em>hosts</em> (devices). Hosts can be on the same or a different network and thanks to IP the communication works. However IP only permits a message from one host to the other and no more than that.
    </p>
  
    <p class='mb-3'>
      Because of this limitation, with IP alone we cannot communicate between different application running on different or even the same host.
    </p>
  
    <p class='mb-3'>
      Indeed there are generally multiple applications running on the same host. These applications all want to send and receive data simultaneously.
    </p>
  
    <p class='mb-3'>
      To do so, we need <em>multiplexing</em> and <em>demultiplexing</em>.
    </p>
  <h2 id='multiplexing-and-demultiplexing' class='inline-block mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Multiplexing and Demultiplexing</h2>
    <p class='mb-3'>
      Multiplexing, and its reverse process demultiplexing, as a general concept can be applied to a lots of contexts in communication network. Think how an optical fibres can carry multiple light signals at differnt angles of recration, or radio waves carrying signals at different frequencies. These are examples of multiplexing. At the Transport level though, multiplexing is done using <strong>network ports</strong>.
    </p>
  <h3 id='ports' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Ports</h3>
    <p class='mb-3'>
      A port is like an integer between the range 0-65535 which serves as an identifier for a specific process running on a host. The range is separated in three sub-range:
    </p>
  
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          <strong>0-1023</strong>: well-known ports. Used for commonly used network services such as HTTP (80), HTTPS (443), SMTP (25), DNS (53) etc.
        </li>
      
        <li>
          <strong>1024-49151</strong>: registered ports. Assigned to private entities but sometimes used for <em><a href='https://en.wikipedia.org/wiki/Ephemeral_port' class='text-violet-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>ephemeral ports</a></em>
        </li>
      
        <li>
          <strong>49152-65535</strong>: dynamic ports (or private ports). Used for customized services or for allocation as <em>ephemeral ports</em>.
        </li>
      
    </ul>
  
    <p class='mb-3'>
      Services running on a server directly are most likely using a port in the <em>well-known</em> range (first range). For example a web server using HTTP will likely have port 80 assigned to it. We say the web server is <em>listening</em> on port 80.
    </p>
  
    <p class='mb-3'>
      A service running on a client machine like in a browser, however, will instead use an <em>ephemeral</em> or temporary port assigned to it by the operating system (third range).
    </p>
  
    <p class='mb-3'>
      The source and destination port numbers are included in the Protocol Data Units (PDU) for the transport layer in two header fields aptly named “Source Port” and “Destination Port”.
    </p>
  
    <p class='mb-3'>
      Using both the IP address and the port number permets end-to-end communication between specific applications on a different machines. This combination is referred to as <em>communication end-point</em>. The communication end-point is referred to as a <strong>socket</strong>.
    </p>
  
    <p class='mb-3'>
      We can use the <code class='py-0.5 px-0.5 bg-gray-100'>netstat -ntup</code> command to produce a list of active network connections.
    </p>
  <h3 id='sockets' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Sockets</h3>
    <p class='mb-3'>
      The term “sockets” is used differently depending on the context. As a concept, it defines an endpoint for inter-process communication.
    </p>
  
    <p class='mb-3'>
      For Internet communication, it is as described above a inter-process communication mechanism between networked processes on different machine, but sometimes on the same.
    </p>
  
    <p class='mb-3'>
      UNIX sockets are a different beast: it’s a mechanism for communication between local processes running on the same machine.
    </p>
  
    <p class='mb-3'>
      In programming, a <em>socket</em> object is often instantiated; this object will take care of some of the network and communication-related tasks.
    </p>
  
    <p class='mb-3'>
      Most language follow the <a href='https://en.wikipedia.org/wiki/Berkeley_sockets' class='text-violet-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>Berkley sockets</a> API model for their implementation.
    </p>
  <h2 id='protocol' class='inline-block mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Protocol</h2>
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          <a href='computing/network/transmission-control-protocol' class='text-violet-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkBranch'>Transmission Control Protocol (TCP)</a>
        </li>
      
        <li>
          <a href='computing/network/user-datagram-protocol' class='text-violet-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkBranch'>User Datagram Protocol (UDP)</a>
        </li>
      
    </ul>
  

  <div class='flex items-center justify-center mt-2'>
  
    
      <a class='text-gray-300 hover:text-violet-600 text-sm' title='Edit this page on GitHub' href='${value:editBaseUrl}/computing/network/transport-layer.md'>
        <svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
          <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z'></path>
        </svg>
      </a>
    
  
</div>
</article>
              <div class='flex flex-col lg:flex-row lg:space-x-2'>
                
                
  <div class='flex-1 p-4 mt-8 bg-gray-100 rounded'>
    <header class='mb-2 text-xl font-semibold text-gray-500'>Links to this page</header>
    <ul class='space-y-1'>
      
        <li>
          <a class='text-violet-600 mavenLinkBold hover:bg-violet-50' href='computing/network/user-datagram-protocol'>
            User Datagram Protocol (UDP)
          </a>
          
            <div class='mb-4 overflow-auto text-sm text-gray-500'>
  
    <div class='pl-2 mt-2 border-l-2 border-violet-200 hover:border-violet-500'>
      <div><p>UDP is a <strong>connectionless</strong> protocol: using UDP at the <a href='computing/network/transport-layer' class='text-gray-600 font-bold hover:bg-gray-50' data-wikilink-type='WikiLinkNormal'>Transport Layer</a>, application can just start sending data without having to wait for a connection to be established with the receiver and the delay induced by waiting for acknowledgements (<code>ACK</code>) and retransmission of lost/corrupt data.</p></div>
    </div>
  
</div>
          
        </li>
      
        <li>
          <a class='text-violet-600 mavenLinkBold hover:bg-violet-50' href='computing/network/tls-handshake'>
            TLS Handshake
          </a>
          
            <div class='mb-4 overflow-auto text-sm text-gray-500'>
  
    <div class='pl-2 mt-2 border-l-2 border-violet-200 hover:border-violet-500'>
      <div><p>The TLS Handshake is a 4 steps, fairly complex process. It takes place after the TCP Handshake and assumes TCP is being used at the <a href='computing/network/transport-layer' class='text-gray-600 font-bold hover:bg-gray-50' data-wikilink-type='WikiLinkNormal'>Transport Layer</a>.</p></div>
    </div>
  
</div>
          
        </li>
      
        <li>
          <a class='text-violet-600 mavenLinkBold hover:bg-violet-50' href='computing/software/ruby/learning-tracks/study-guide-test'>
            Study Guide for Test
          </a>
          
            <div class='mb-4 overflow-auto text-sm text-gray-500'>
  
    <div class='pl-2 mt-2 border-l-2 border-violet-200 hover:border-violet-500'>
      <div><a href='computing/network/transport-layer' class='text-gray-600 font-bold hover:bg-gray-50' data-wikilink-type='WikiLinkNormal'>Transport Layer</a></div>
    </div>
  
</div>
          
        </li>
      
        <li>
          <a class='text-violet-600 mavenLinkBold hover:bg-violet-50' href='computing/network/networking-models'>
            Networking Models
          </a>
          
            <div class='mb-4 overflow-auto text-sm text-gray-500'>
  
    <div class='pl-2 mt-2 border-l-2 border-violet-200 hover:border-violet-500'>
      <div>Layer 3: <a href='computing/network/transport-layer' class='text-gray-600 font-bold hover:bg-gray-50' data-wikilink-type='WikiLinkBranch'>Transport Layer</a></div>
    </div>
  
    <div class='pl-2 mt-2 border-l-2 border-violet-200 hover:border-violet-500'>
      <div>Layer 4: <a href='computing/network/transport-layer' class='text-gray-600 font-bold hover:bg-gray-50' data-wikilink-type='WikiLinkBranch'>Transport Layer</a></div>
    </div>
  
</div>
          
        </li>
      
        <li>
          <a class='text-violet-600 mavenLinkBold hover:bg-violet-50' href='computing/network/message-authentication-code'>
            Message Authentication Code (MAC)
          </a>
          
            <div class='mb-4 overflow-auto text-sm text-gray-500'>
  
    <div class='pl-2 mt-2 border-l-2 border-violet-200 hover:border-violet-500'>
      <div>Sender encrypt the data payload using the symmetric key, encapsulate it and pass the result to the <a href='computing/network/transport-layer' class='text-gray-600 font-bold hover:bg-gray-50' data-wikilink-type='WikiLinkNormal'>Transport Layer</a></div>
    </div>
  
</div>
          
        </li>
      
    </ul>
  </div>

              </div>
              
  <section class='flex flex-wrap items-end justify-center my-4 space-x-2 space-y-2 font-mono text-sm'>
    
  </section>

              <div class='flex items-center justify-end pb-3'>
  
    <time class='p-2 text-sm text-gray-500' datetime='<!-- TODO -->'>
      2021-09-10T09:51
    </time>
  
</div>

            </main>
          </div>
        </div>
        <footer class='flex items-center justify-center mt-2 mb-8 space-x-4 text-center text-gray-800'>
  
  <div>
    <a href='' title='Go to Home page'>
      <svg xmlns='http://www.w3.org/2000/svg' class='w-6 h-6 hover:text-violet-700' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6'></path>
      </svg>
    </a>
  </div>
  <div>
    <a href='-/all' title='View Index'>
      <svg class='w-6 h-6 hover:text-violet-700' fill='none' stroke='currentColor' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4'>
        </path>
      </svg>
    </a>
  </div>
  <div>
    <a href='https://emanote.srid.ca' target='_blank' title='Generated by Emanote 1.0.3.5'>
      <img class='w-6 h-6 hover:text-violet-700' src='_emanote-static/emanote-logo.svg' />
    </a>
  </div>
  <div>
    <a href='-/tags' title='View tags'>
      <svg class='w-6 h-6 hover:text-violet-700' fill='none' stroke='currentColor' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z'>
        </path>
      </svg>
    </a>
  </div>
  <div>
    <a href='-/tasks' title='View tasks'>
      <svg xmlns='http://www.w3.org/2000/svg' class='w-6 h-6 hover:text-violet-700' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z'></path>
      </svg>
    </a>
  </div>
</footer>
      </div>
    </div>
  
  <div id='stork-search-container' class='hidden fixed w-screen h-screen inset-0 backdrop-filter backdrop-blur-sm'>
  <div class='fixed w-screen h-screen inset-0' onclick='window.emanote.stork.toggleSearch()'></div>

  <div class='container mx-auto p-10 mt-10'>
    <div class='stork-wrapper-flat container mx-auto'>
      <input id='stork-search-input' data-stork='emanote-search' class='stork-input' placeholder='Search (Ctrl+K) ...' />
      <div data-stork='emanote-search-output' class='stork-output'></div>
    </div>
  </div>
</div>
  
    
  
</body>

</html>