<!DOCTYPE html>
<!-- TODO: Main navigation links (Home, index, tags, ...) --><!-- DoNotFormat -->
<!-- DoNotFormat -->

<html lang='en'>

<head>
  <meta charset='UTF-8' />
  <meta name='viewport' content='width=device-width, initial-scale=1' />
  <title>
    OAuth 2.0 and OpenID Connect – エキソブレイン
  </title>
  
    
      <meta property='og:description' content='OAuth 2.0 is for authorization while OpenID Connect is for authentication.' />
      <meta property='og:site_name' content='エキソブレイン' />
      <meta property='og:image' content />
      <meta property='og:type' content='website' />
      <meta property='og:title' content='OAuth 2.0 and OpenID Connect' />
    
    
      <base href='/' />
      <link href='favicon.svg' rel='icon' />
    
    <meta name='generator' content='Emanote' />

  
  <link href='tailwind.css?instanceId=42ac17e4-abb7-46cd-ae44-4ce804272508' rel='stylesheet' type='text/css' />

  <!-- Heist error element -->
  <style>
    strong.error {
      color: lightcoral;
      font-size: 90%;
      font-family: monospace;
    }
  </style>
  <!-- What goes in this file will appear on near the end of <head>--><link rel='preload' href='_emanote-static/fonts/Maven_Pro/MavenPro-VariableFont_wght.ttf' as='font' type='font/ttf' crossorigin />

<style>
  @font-face {
    font-family: 'MavenPro';
    /* FIXME: This ought to be: ${ema:emanoteStaticLayerUrl}/fonts/Maven_Pro/MavenPro-VariableFont_wght.ttf */
    src: url(_emanote-static/fonts/Maven_Pro/MavenPro-VariableFont_wght.ttf) format("truetype");
    font-display: swap;
  }

  body {
    font-family: 'MavenPro', sans-serif;
    /* font-variation-settings: 'wght'300; */
  }

  a.mavenLinkBold {
    font-variation-settings: 'wght'500;
  }

  strong {
    font-variation-settings: 'wght'500;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  header,
  .header-font {
    font-family: 'MavenPro', sans-serif;
  }
</style>

  
    <link rel='stylesheet' href='_emanote-static/inverted-tree.css' />
  
</head>

<!-- DoNotFormat -->



<!-- DoNotFormat -->

<body class='bg-gray-400 overflow-y-scroll'>
  
    <div class='container mx-auto max-w-prose'>
      <div class='mt-2 md:mt-4'>
        <!-- DoNotFormat -->
<!-- DoNotFormat -->

<nav id='uptree' class='flipped tree' style='transform-origin: 50%;'>
  <ul class='root'>
    <li>
      
        <ul>
          
            <li>

  <div class='text-gray-900 forest-link'>
    <a href='computing/software'>
      Software
    </a>
  </div>

  
    <ul>
      
        <li>

  <div class='text-gray-900 forest-link'>
    <a href='computing'>
      Computing
    </a>
  </div>

  
    <ul>
      
        <li>

  <div class='text-gray-900 forest-link'>
    <a href=''>
      外付け脳 (exobrain)
    </a>
  </div>

  
</li>
      
    </ul>
  
</li>
      
    </ul>
  
</li>
          
        </ul>
      
    </li>
  </ul>
</nav>
        <div class='md:shadow-2xl md:mb-8'>
          <div class='flex-1 w-full overflow-x-auto bg-white'>
            <main class='px-4 py-4'>
              <h1 class='flex items-end justify-center mb-4 p-3 bg-violet-100 text-5xl font-extrabold text-black rounded'>
  <a class='z-40 tracking-tighter '>
    OAuth 2.0 and OpenID Connect
  </a>
</h1>
              <article class='overflow-auto'>
  <!-- What goes in this file will appear on top of note body-->
  
    <p class='mb-3'>
      <strong>OAuth 2.0</strong> is for <strong>authorization</strong> while <strong>OpenID Connect</strong> is for <strong>authentication</strong>.
    </p>
  <h2 id='oauth-20' class='inline-block mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>OAuth 2.0</h2><div class='ui warning message'>
    <p class='mb-3'>
      While there is a OAuth 1.0, it is deprecated and 2.0 should be used every time.
    </p>
  </div>
    <p class='mb-3'>
      OAuth 2.0 is a <strong>delegated authorization</strong> services. At a high level, it works as follows:
    </p>
  
    <ul class='my-3 ml-6 space-y-1 list-decimal list-inside'>
      
        <li>
          An application will integrate a “Connect with <em>website_name</em>” button
        </li>
      
        <li>
          On click, the user browser will redirect over to that website and they will be prompted to login (email and password). With the redirection, the callback URL, response type and scope(s) are specified
        </li>
      
        <li>
          After successful login, the website will ask something along the line of “Allow <em>application</em> to access <em>whatever_info</em>?” with a yes/no call to action. This is important: explicit consent is key
        </li>
      
        <li>
          If the user click “yes”, the browser redirects back to the first application <strong>callback</strong> or <strong>redirect URI</strong> with an authorization code.
        </li>
      
        <li>
          The application use the authorization code to ask the website for an access token.
        </li>
      
        <li>
          The website check the authenticity and validity of the authorization token and exchange it with an access token.
        </li>
      
        <li>
          Now the application contacts the website’s API and ask for <em>whatever_info</em> by presenting the authorization token thing that let the website knows the application is allowed to access this information.
        </li>
      
    </ul>
  
    <p class='mb-3'>
      OAuth is a <strong>authorization</strong> service. However, starting with Google or Facebook login button, it also became an authentication service, which it wasn’t designed for at first. This implementation introduces problem because there is no standard way to get user’s information and every implementation and scopes are different.
    </p>
  <h3 id='terminology' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Terminology</h3>
    <p class='mb-3'>
      OAuth 2.0 uses confusing terminologies that just renames things that are already named.
    </p>
  
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Resource owner: you and me (the user who clicks on “yes” or “no” and who owns the data)
        </li>
      
        <li>
          Client: the application that want to access the data
        </li>
      
        <li>
          Authorization server: the website the user is redirected to allow the sharing of the data
        </li>
      
        <li>
          Resource server: the server with the API or system that actually <em>holds</em> the data (not always the same as the authorization server)
        </li>
      
        <li>
          Authorization grant: the “special magic thing” to prove the user consented to share the data
        </li>
      
        <li>
          Redirect URI: where the browser should go back at the end of the consent dance executed beforehand
        </li>
      
        <li>
          Access token: the actual token or key needed to access the data for which permission was granted, on the resource server
        </li>
      
        <li>
          Scopes/Consents: a list of scopes that the authorization server understands. A list of permissions that make sense for this system
        </li>
      
    </ul>
  
    <p class='mb-3'>
      The reason there is two tokens (authorization grant and access token) is because of network security concepts called <em>back channel</em> (highly secure channel) and <em>front channel</em> (less secure channel).
    </p>
  
    <p class='mb-3'>
      Most of the OAuth ceremony occurs on the back channel, i.e., between the browser and a website. In the case where there is only an authorization grant, and if the network or the browser is compromised (via malicious extension for example), an attacker could potentially grab the authorization grant and claim the data before you.
    </p>
  
    <p class='mb-3'>
      The access token, however, can only be claimed on a back channel. In addition to the authorization grant, the server also sends a secret key that only the client (server) knows. This is to let the resource server knows that this client did not steal the authorization grant. This secret key never goes to the front channel.
    </p>
  
    <p class='mb-3'>
      There exist an <strong>implicit flow</strong> which does not require an authorization grant. In this case, the client asks for the token directly. It is less secure for the reason cited above and should not be used if there is a way to use the back channel (it is mainly used by single page application with no back end).
    </p>
  <h2 id='openid-connect' class='inline-block mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>OpenID Connect</h2>
    <p class='mb-3'>
      As OAuth 2.0 was not designed to do authentication, some smart people added a little bit of whatever OAuth is missing for doing proper authentication use case. Out of that effort comes <strong>OpenID Connect</strong>.
    </p>
  
    <p class='mb-3'>
      OpenID Connect adds:
    </p>
  
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          ID token: represents the user or the information about the user
        </li>
      
        <li>
          UserInfo endpoint for getting more user information: used to retrieve user information
        </li>
      
        <li>
          Standard set of scopes
        </li>
      
        <li>
          Standardized implementation
        </li>
      
    </ul>
  
    <p class='mb-3'>
      The authorization flow is similar to OAuth 2.0’s; the only difference is as a <code class='py-0.5 px-0.5 bg-gray-100'>Scope</code> we ask for <code class='py-0.5 px-0.5 bg-gray-100'>openid profile</code>. Technically it’s both a OAuth 2.0 request and OpenID Connect request.
    </p>
  
    <p class='mb-3'>
      The ID token is A JSON web token (JWT) which is a standard way of encoding a bunch of information in a way that’s easy to transmit over the internet. It can be decoded to reveal a header, a payload (or claim) and a signature. The signature is a way to verify the payload has not been modified or forged before reception.
    </p>
  
  <div class='flex items-center justify-center mt-2'>
  
    
      <a class='text-gray-300 hover:text-violet-600 text-sm' title='Edit this page on GitHub' href='https://github.com/cyberflamingo/exobrain/edit/master/content/computing/software/oauth-openid-connect.md'>
        <svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
          <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z'></path>
        </svg>
      </a>
    
  
</div>
</article>
              <div class='flex flex-col lg:flex-row lg:space-x-2'>
                
                
  <div class='flex-1 p-4 mt-8 bg-gray-100 rounded'>
    <header class='mb-2 text-xl font-semibold text-gray-500'>Links to this page</header>
    <ul class='space-y-1'>
      
        <li>
          <a class='text-violet-600 mavenLinkBold hover:bg-violet-50' href='computing/software'>
            Software
          </a>
          
            <div class='mb-4 overflow-auto text-sm text-gray-500'>
  
    <div class='pl-2 mt-2 border-l-2 border-violet-200 hover:border-violet-500'>
      <div><a href='computing/software/oauth-openid-connect' class='text-gray-600 font-bold hover:bg-gray-50' data-wikilink-type='WikiLinkBranch'>OAuth 2.0 and OpenID Connect</a></div>
    </div>
  
</div>
          
        </li>
      
    </ul>
  </div>

              </div>
              
  <section class='flex flex-wrap items-end justify-center my-4 space-x-2 space-y-2 font-mono text-sm'>
    
  </section>

              <!-- What goes in this file will at the very end of the main div -->
            </main>
          </div>
        </div>
        <footer class='flex items-center justify-center mt-2 mb-8 space-x-4 text-center text-gray-800'>
  
  <div>
    <a href='' title='Go to Home page'>
      <svg xmlns='http://www.w3.org/2000/svg' class='w-6 h-6 hover:text-violet-700' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6'></path>
      </svg>
    </a>
  </div>
  <div>
    <a href='-/all' title='View Index'>
      <svg class='w-6 h-6 hover:text-violet-700' fill='none' stroke='currentColor' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4'>
        </path>
      </svg>
    </a>
  </div>
  <div>
    <a href='https://emanote.srid.ca' target='_blank' title='Generated by Emanote 0.6.21.0'>
      <img class='w-6 h-6 hover:text-violet-700' src='_emanote-static/emanote-logo.svg' />
    </a>
  </div>
  <div>
    <a href='-/tags' title='View tags'>
      <svg class='w-6 h-6 hover:text-violet-700' fill='none' stroke='currentColor' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z'>
        </path>
      </svg>
    </a>
  </div>
  <div>
    <a href='-/tasks' title='View tasks'>
      <svg xmlns='http://www.w3.org/2000/svg' class='w-6 h-6 hover:text-violet-700' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z'></path>
      </svg>
    </a>
  </div>
</footer>
      </div>
    </div>
  
</body>

</html>